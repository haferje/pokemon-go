<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="description" content="">
		<meta name="author" content="">
		<link rel="icon" href="">

		<title>Pokemon Go Viewer</title>

		<!-- vendor styles -->
		<link href="https://unpkg.com/tabulator-tables@4.2.0/dist/css/tabulator.min.css" rel="stylesheet">

		<!-- vendor scripts -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.11/lodash.min.js"></script>
		<script src="https://unpkg.com/tabulator-tables@4.2.0/dist/js/tabulator.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

		<!-- data scripts -->
		<script src="data/pokemon.js"></script>
		<script src="data/moves.js"></script>
		<script src="data/types.js"></script>
		<script src="data/flavors.js"></script>

		<!-- styles -->
		<style>
			/** { font-size: 8pt; }*/

			td.indent { padding-left:40px; }

			.type {
				display: inline-block;
				padding: 3px;
				border-radius: 3px;
				margin-right: 1px;
			}
			.type__xx{
				border: 1px solid black; /* in case browser doesn't understand rgba */
				border: 1px solid rgba(0, 0, 0, .5);
				/* ensure the border remains transparent even if a solid background color is applied */
				-webkit-background-clip: padding-box; /* for Safari */
				background-clip: padding-box; /* for IE9+, Firefox 4+, Opera, Chrome */
			}
			.type.type-bug		{ background-color: #9cb820; }
			.type.type-dark		{ background-color: #504843; }
			.type.type-dragon	{ background-color: #7038f8; }
			.type.type-electric	{ background-color: #f8d030; }
			.type.type-fairy	{ background-color: #f09ad9; }
			.type.type-fighting	{ background-color: #c03028; }
			.type.type-fire		{ background-color: #f08030; }
			.type.type-flying	{ background-color: #9096f0; }
			.type.type-ghost	{ background-color: #705898; }
			.type.type-grass	{ background-color: #22c02a; }
			.type.type-ground	{ background-color: #e0b668; }
			.type.type-ice		{ background-color: #98d8d8; }
			.type.type-normal	{ background-color: #a8a8a8; }
			.type.type-poison	{ background-color: #a040a0; }
			.type.type-psychic	{ background-color: #f85888; }
			.type.type-rock		{ background-color: #b8a038; }
			.type.type-steel	{ background-color: #6d8f9c; }
			.type.type-water	{ background-color: #6890f0; }

			img.photo {
				max-height: 64px;
				width: auto;
				height: auto;
			}
		</style>

		<!-- app scripts -->
		<script>

Tabulator.prototype.extendModule('format', 'formatters', {
	list: function(cell, formatterParams) {
		return cell.getValue().join('<br/>');
	},
	percent: function(cell, formatterParams) {
		return (cell.getValue() * 100).toFixed(1) + ' %';
	},
	// photo:  function(cell, formatterParams) {
	// 	var imageFormatter = Tabulator.prototype.moduleBindings.format.prototype.formatters.image;
	// 	var formatterParams = { height:"50px", width:"50px" };

	// 	var dex = cell.getValue();
	// 	var paddedDex = ('00'+dex).slice(-3);
	// 	var url = `https://www.serebii.net/pokemongo/pokemon/${paddedDex}.png`;

	// 	cell._cell.value = url;

	// 	return imageFormatter(cell, formatterParams);
	// },
});

				pokemon = _.take(pokemon, 15);

				pokemon = _.map(pokemon, p => ({
					dex         : p.dex,
					name        : p.name,
					buddy       : p.kmBuddyDistance,
					maxCP       : p.maxCP,
					quickMoves  : _.map(p.quickMoves, m => m.name.replace(' Fast', '')),
					chargeMoves : _.map(p.cinematicMoves, m => m.name),
					family      : p.family.name,
					attack      : p.stats.baseAttack,
					defense     : p.stats.baseDefense,
					stamina     : p.stats.baseStamina,
					types       : _.map(p.types, t => t.name),
					fleeRate    : p.encounter.baseFleeRate,
					captureRate : p.encounter.baseCaptureRate,
					male        : p.encounter.gender.malePercent,
					female      : p.encounter.gender.femalePercent,
					// evolutions: null,
					// forms: null,
					photo       : `https://www.serebii.net/pokemongo/pokemon/${('00'+p.dex).slice(-3)}.png`,
				}));

				console.table(pokemon);

			$(() => {

				var table = new Tabulator('#tabulator', {
					data: pokemon,
					columns: [
						{ title: '#', field: 'dex', align: 'right' },
						{ title: 'Photo', field: 'photo', align: 'center', formatter: 'image', formatterParams: { height: '50px', width: '50px' } },
						{ title: 'Name', field: 'name' },
						{ title: 'Buddy', field: 'buddy', align: 'right' },
						{ title: 'Max CP', field: 'maxCP', align: 'right' },
						{ title: 'Quick', field: 'quickMoves', formatter: 'list' },
						{ title: 'Charge', field: 'chargeMoves', formatter: 'list' },
						{ title: 'Family', field: 'family' },
						{ title: 'Attack', field: 'attack', align: 'right' },
						{ title: 'Defense', field: 'defense', align: 'right' },
						{ title: 'Stamina', field: 'stamina', align: 'right' },
						{ title: 'Types', field: 'types', formatter: 'list' },
						{ title: 'Flee', field: 'fleeRate', align: 'right', formatter: 'percent' },
						{ title: 'Capture', field: 'captureRate', align: 'right', formatter: 'percent' },
						{ title: 'Male', field: 'male', align: 'right', formatter: 'percent' },
						{ title: 'Female', field: 'female', align: 'right', formatter: 'percent' },
						// { title: 'Photo', field: 'dex', align: 'right', formatter: 'photo' },
					],
					height: 300,
				});

			});
// 			var paddedDex = ('00'+monster.dex).slice(-3);
// 			var image = `https://www.serebii.net/pokemongo/pokemon/${paddedDex}.png`;


// var move: _.find(moves, { id: this.moveID })
// 		var monster = _.find(pokemon, { id: this.monsterID });
// 		var effects = _(this.monster.types)
// 			.map(type => _.find(types, { id: type.id }).damage)
// 			.flatten()
// 			.groupBy('id')
// 			.map((group, key) => ({
// 				// id: key,
// 				name:			_.find(types, { id: key }).name,
// 				attackScalar:	_.multiply.apply(null, _.map(group, 'attackScalar')).toFixed(3),
// 			}))
// 			.orderBy(['attackScalar', 'name'], ['desc', 'asc'])
// 			.groupBy('attackScalar')
// 			.value();



		</script>
	</head>

	<body>

		<div id="tabulator"></div>

	</body>
</html>
